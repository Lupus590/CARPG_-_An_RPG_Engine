if (self.CavalryLogger) { CavalryLogger.start_js(["\/WBa6"]); }

__d('AdsPagerConstants',['keyMirror'],(function a(b,c,d,e,f,g){var h=c('keyMirror')({ADD_PAGE:null,PAGE_TRANSITION:null,REQUEST_PAGE:null}),i=c('keyMirror')({VIEW_ACTION:null,SERVER_ACTION:null});f.exports={ActionTypes:h,PayloadSources:i}}),null);
__d('AdsPagerDispatcher',['AdsPagerConstants','Dispatcher_DEPRECATED'],(function a(b,c,d,e,f,g){'use strict';var h=c('AdsPagerConstants').PayloadSources;function i(k){return function(l){this.dispatch({payloadSource:k,action:l})}}var j=Object.assign(new (c('Dispatcher_DEPRECATED'))(),{handleUpdateFromViewAction:i(h.VIEW_ACTION),handleUpdateFromServerAction:i(h.SERVER_ACTION)});f.exports=j}),null);
__d('AdsRefreshHandler',['csx','AdsMouseStateStore','AdsPagerConstants','AdsPagerDispatcher','Arbiter','CSSFade','DataAttributeUtils','DOM','Event','SubscriptionsHandler','Toggler','UIPagelet','cxodecode','debounceAcrossTransitions','getOrCreateDOMID'],(function a(b,c,d,e,f,g,h){var i=c('AdsMouseStateStore').STATES,j=600,k=c('AdsMouseStateStore').get(),l=void 0;function m(n,o,p){'use strict';if(!p.data||!p.pid)return;if(o.nonce)l=c('cxodecode')(o.nonce);this.$AdsRefreshHandler1=n;this.$AdsRefreshHandler2=Date.now();this.$AdsRefreshHandler3=o;this.$AdsRefreshHandler4=p;this.$AdsRefreshHandler5=0;this.$AdsRefreshHandler6=false;this.$AdsRefreshHandler7=true;this.$AdsRefreshHandler8=null;this.$AdsRefreshHandler9=c('debounceAcrossTransitions')(this.reloadAdsIfNeeded.bind(this),this.$AdsRefreshHandler3.delay);this.$AdsRefreshHandler10=new (c('SubscriptionsHandler'))();this.$AdsRefreshHandler10.addSubscriptions(c('Event').listen(this.$AdsRefreshHandler1,'mouseenter',this.setMouseOver.bind(this,true)),c('Event').listen(this.$AdsRefreshHandler1,'mouseleave',this.setMouseOver.bind(this,false)),k.addListener('change',this.onMouseStateStoreChange.bind(this)),c('Arbiter').subscribe('AdsPreferencesDialog/opened',this.stopRefreshingRHC.bind(this)),c('Arbiter').subscribe('AdsPreferencesDialog/closed',this.startRefreshingRHC.bind(this)),c('Arbiter').subscribe('VideoChannelView/opened',this.stopRefreshingRHC.bind(this)),c('Arbiter').subscribe('VideoChannelView/closed',this.startRefreshingRHC.bind(this)));this.$AdsRefreshHandler11();c('AdsPagerDispatcher').register(this.handlePageDispatch.bind(this))}m.prototype.$AdsRefreshHandler11=function(){'use strict';if(this.$AdsRefreshHandler12)this.$AdsRefreshHandler12.release();this.$AdsRefreshHandler12=new (c('SubscriptionsHandler'))();var n=c('DOM').scry(this.$AdsRefreshHandler1,'.uiToggle');for(var o=0;o<n.length;o++)this.$AdsRefreshHandler12.addSubscriptions(c('Toggler').listen('show',n[o],this.stopRefreshingRHC.bind(this)),c('Toggler').listen('hide',n[o],this.startRefreshingRHC.bind(this)));};m.prototype.handlePageDispatch=function(n){'use strict';var o=n.action||{};if(o.actionType===c('AdsPagerConstants').ActionTypes.REQUEST_PAGE)this.reloadAds();};m.prototype.setMouseOver=function(n){'use strict';this.$AdsRefreshHandler13=n;if(n&&this.$AdsRefreshHandler8!=null){this.$AdsRefreshHandler8.cancel();this.$AdsRefreshHandler8=null}};m.prototype.subscribeDefaultEventsForRefresh=function(){'use strict';this.$AdsRefreshHandler10.addSubscriptions(c('Event').listen(window,'scroll',this.$AdsRefreshHandler9),c('Event').listen(window,'resize',this.$AdsRefreshHandler9));return this};m.prototype.reloadWithDebounce=function(){'use strict';this.$AdsRefreshHandler9()};m.prototype.reloadWithoutDebounce=function(){'use strict';this.reloadAdsIfNeeded()};m.prototype.stopRefreshingRHC=function(n,o){'use strict';this.$AdsRefreshHandler7=false};m.prototype.startRefreshingRHC=function(n,o){'use strict';this.$AdsRefreshHandler2=Date.now();this.$AdsRefreshHandler7=true};m.prototype.forceLoadIfEnoughTimePassed=function(n){'use strict';if(Date.now()-this.$AdsRefreshHandler2>n)this.reloadAds();};m.prototype.containsPremium=function(){'use strict';var n=c('DOM').scry(this.$AdsRefreshHandler1,l||"div._4u8");return !!n.filter(function(o){return JSON.parse(c('DataAttributeUtils').getDataAttribute(o,'data-ad')).segment==='premium'}).length};m.prototype.reloadAdsIfNeeded=function(){'use strict';if(!this.$AdsRefreshHandler1)return;c('Arbiter').inform('AdsRefreshHandler/CheckingReload');if(this.$AdsRefreshHandler3.stateRefresh){this.reloadAdsIfNeededStateBased();return}if(this.containsPremium()||this.$AdsRefreshHandler13||!this.$AdsRefreshHandler3.interval)return;if(Date.now()-this.$AdsRefreshHandler2>=this.$AdsRefreshHandler3.interval)this.reloadAds();};m.prototype.reloadAdsIfNeededStateBased=function(){'use strict';if(Date.now()-this.$AdsRefreshHandler2<this.$AdsRefreshHandler3.interval)return;if(this.containsPremium())return;if(!this.$AdsRefreshHandler3.interval)return;this.$AdsRefreshHandler6=true;c('Arbiter').inform('AdsRefreshHandler/RefreshScheduled');this.checkScheduledRefresh()};m.prototype.getRefreshScheduled=function(){'use strict';return this.$AdsRefreshHandler6};m.prototype.onMouseStateStoreChange=function(){'use strict';this.checkScheduledRefresh()};m.prototype.checkScheduledRefresh=function(){'use strict';if(!this.$AdsRefreshHandler6)return;if(this.$AdsRefreshHandler13)return;var n=k.getState(),o=false;switch(n){case i.HOVER:case i.NO_INTENT:o=true;break;default:break;}if(!o)return;this.$AdsRefreshHandler6=false;this.reloadAds()};m.prototype.reloadAds=function(){'use strict';if(!this.$AdsRefreshHandler1)return;this.$AdsRefreshHandler2=Date.now();if(!this.$AdsRefreshHandler7)return;var n=this.$AdsRefreshHandler4&&this.$AdsRefreshHandler4.data,o=babelHelpers['extends']({},n,{refresh_num:++this.$AdsRefreshHandler5});this.$AdsRefreshHandler8=c('UIPagelet').loadFromEndpoint('WebEgoPane',this.$AdsRefreshHandler1,{dom_id:c('getOrCreateDOMID')(this.$AdsRefreshHandler1),pid:this.$AdsRefreshHandler4.pid,data:o},{bundle:false,handler:this.onLoadHandler.bind(this)});c('Arbiter').inform('AdsRefreshHandler/AdsLoading')};m.prototype.onLoadHandler=function(){'use strict';c('Arbiter').inform('AdsRefreshHandler/AdsLoaded');this.$AdsRefreshHandler8=null;this.$AdsRefreshHandler11();if(!this.$AdsRefreshHandler3.fade)return;c('CSSFade').show(this.$AdsRefreshHandler1,{duration:j})};m.prototype.cleanup=function(){'use strict';this.$AdsRefreshHandler1=null;this.$AdsRefreshHandler10.release();this.$AdsRefreshHandler9.reset()};f.exports=m}),null);
__d('HomeRHCAdsBasicRefresh',['AdsRefreshHandler','Arbiter','NavigationMessage','Run','SubscriptionsHandler','ge'],(function a(b,c,d,e,f,g){var h,i,j,k;function l(){if(h){h.cleanup();h=null}if(i){i.release();i=null}j=null}function m(){var p=c('ge')(k);if(p&&j){p.appendChild(j);j=null}}function n(p,q){j=q;h&&h.forceLoadIfEnoughTimePassed(0)}var o={init:function p(q,r,s){k=q;h=new (c('AdsRefreshHandler'))(c('ge')(q),r,s).subscribeDefaultEventsForRefresh();i=new (c('SubscriptionsHandler'))();i.addSubscriptions(c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,l),c('Arbiter').subscribe('ProfileQuestionAnswered',n),c('Arbiter').subscribe('AdsRefreshHandler/AdsLoaded',m));c('Run').onLeave(l)}};f.exports=o}),null);
__d('runAfterScrollingStops',['Arbiter','Event','Run','debounceAcrossTransitions','emptyFunction'],(function a(b,c,d,e,f,g){function h(s,t,u){if(t&&k[t])return;if(!j){c('Arbiter').subscribe('page_transition',r);j=true}if(!i){s();return}t&&(k[t]=1);l.push(s);if(!u){if(n){c('Run').onLeave(r);n=false}m.push(l.length-1)}}var i,j,k={},l=[],m=[],n=true,o=500,p=c('debounceAcrossTransitions')(function(){i=false;var s=l;l=[];m=[];k={};for(var t=0,u=s.length;t<u;++t)s[t]();},o);function q(){i=true;p()}function r(){var s=m;m=[];n=true;for(var t=0,u=s.length;t<u;++t)l[s[t]]=c('emptyFunction');}c('Event').listen(window,'scroll',q);f.exports=h}),null);
__d('LitestandOffscreenController',['csx','cx','Arbiter','CSS','DOMQuery','Event','NavigationMessage','Run','Scroll','Style','SubscriptionsHandler','Vector','getFullScreenElement','getOrCreateDOMID','queryThenMutateDOM','runAfterScrollingStops','throttle'],(function a(b,c,d,e,f,g,h,i){var j=1,k=9,l=10,m={},n=false,o=void 0,p=void 0,q=void 0,r=void 0,s=[];function t(){o&&o.release();o=null;n=false}function u(){m={};s=[]}function v(){if(document.body&&c('CSS').matchesSelector(document.body,"._5vb_"))return l;return k}function w(){r=r||c('Vector').getViewportDimensions().y;p=c('Vector').getScrollPosition().y;q=p+r;if(j){p-=r*j;q+=r*j}for(var ea in m){var fa=m[ea];fa.position=c('Vector').getElementPosition(fa.element).y;if(!fa.hidden)fa.height=fa.element.offsetHeight;}}function x(){var ea=[],fa=c('getFullScreenElement')();for(var ga in m){var ha=m[ga],ia=ha.position||0,ja=ia+ha.height<p,ka=ia>q;if(!fa&&!ha.hidden&&(ja||ka)){y(ha)}else if(!ja&&!ka){ha.pendingHide=false;var la=z(ha);if(ha.hidden){if(ha.dirty&&ia<p){ea.push(ga);if(la)c('CSS').addClass(la,"_49nu");}else c('Style').apply(ha.element,{height:'',marginBottom:''});if(la)c('CSS').show(la);ha.dirty=false;ha.hidden=false}}}if(!ea.length)return;var ma=0;c('queryThenMutateDOM')(function(){for(var na=0,oa=ea.length;na<oa;na++){var pa=m[ea[na]],qa=z(pa);ma+=pa.height+c('Style').getFloat(pa.element,'marginBottom');if(qa)ma-=qa.offsetHeight;}},function(){for(var na=0,oa=ea.length;na<oa;na++){var pa=m[ea[na]],qa=z(pa);if(qa)c('CSS').removeClass(qa,"_49nu");c('Style').apply(pa.element,{height:'',marginBottom:''})}ma&&c('Scroll').setTop(document.body,c('Scroll').getTop(document.body)-ma)})}function y(ea){if(!ea.pendingHide){s.push(ea);ea.pendingHide=true}}function z(ea){if(ea.wrapperElement)return ea.wrapperElement;var fa=ea.element,ga=fa.firstElementChild;if(ga instanceof HTMLElement)return ea.wrapperElement=ga;for(var ha=0;ha<fa.childNodes.length;ha++){var ia=fa.childNodes[ha];if(ia.tagName&&ia instanceof HTMLElement)return ea.wrapperElement=ia;}return null}function aa(){var ea=v()+'px';for(var fa=0;fa<s.length;fa++){var ga=s[fa];if(c('DOMQuery').scry(ga.element,'div[data-fullscreen]').length)ga.pendingHide=false;if(ga&&ga.element&&ga.pendingHide&&!ga.hidden){c('Style').apply(ga.element,{height:(ga.height||0)+'px',marginBottom:ea});var ha=z(ga);if(ha)c('CSS').hide(ha);ga.hidden=true;ga.pendingHide=false}}s=[]}function ba(){c('runAfterScrollingStops')(aa,'LitestandOffscreenController/hide');c('queryThenMutateDOM')(w,x,'LitestandOffscreenController')}function ca(){c('Run').onLeave(t);o=new (c('SubscriptionsHandler'))();o.addSubscriptions(c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,u),c('Event').listen(window,'scroll',c('throttle')(ba)),c('Event').listen(window,'resize',c('throttle')(function(){r=null;ba()})));n=true}var da={attachSubstream:function ea(fa){n||ca();m[c('getOrCreateDOMID')(fa)]={element:fa}}};f.exports=da}),null);
__d('ListestandStreamTailStoryPlaceholderVisbilityTracker',['PageletEventConstsJS','PageletEventsHelper','onRectIsWithinViewport','performanceAbsoluteNow'],(function a(b,c,d,e,f,g){'use strict';var h=null,i=null,j=null,k=false,l={},m={setPlaceholderElement:function o(p){if(!k){c('PageletEventsHelper').subscribeToPageletEvents(n);k=true}h=p;i&&i.remove();i=c('onRectIsWithinViewport')(function(){return p.getBoundingClientRect()},function(q){if(!j&&q)j=c('performanceAbsoluteNow')();})},getStoryPlaceholderVisibleDuration:function o(p){return l[p]||0}};function n(o,p){if(o.startsWith('hyperfeed_story')&&p===c('PageletEventConstsJS').DISPLAY_END){var q=c('performanceAbsoluteNow')();l[o]=j?q-j:0;if(h){var r=h.getBoundingClientRect().top,s=r-window.scrollTop;j=s<window.innerHeight&&s>0?q:null}else j=null;}}f.exports=m}),null);
__d('NewsFeedDedupeStoryController',['CSS','DOMQuery','queryThenMutateDOM'],(function a(b,c,d,e,f,g){var h={dedupe:function i(j,k){c('queryThenMutateDOM')(function(){var l={};return c('DOMQuery').scry(j,k).filter(function(m){var n=m.getAttribute('data-dedupekey');if(n&&c('CSS').shown(m)){if(l[n])return true;l[n]=true}return false})},function(l){l.forEach(function(m){c('CSS').hide(m);m.removeAttribute('style')})},'NewsFeedDedupeStoryControllerDedupe')}};f.exports=h}),null);
__d('LitestandStreamTailLoader',['Arbiter','AsyncResponse','Bootloader','CSS','DOM','Event','FunnelLogger','ListestandStreamTailStoryPlaceholderVisbilityTracker','LitestandMessages','LitestandOffscreenController','LitestandStream','NavigationMessage','NewsFeedDedupeStoryController','OnVisible','Run','SubscriptionsHandler','ge','getElementPosition','getOrCreateDOMID','getUnboundedScrollPosition','getViewportDimensions','throttle'],(function a(b,c,d,e,f,g){'use strict';var h='WWW_NEWSFEED_TAILLOAD_FUNNEL',i=null,j=null,k=null,l=30000,m={'streamload.tail.commence':true,'streamload.tail.success':true,'streamload_error.tail':true,'streamload_error.tail.transport':true,'streamload.tail.retry':true,'streamload_error.tail.retry':true,'streamload_error.tail.final':true,'streamload.tail.retry.success':true,'streamload_timeout.tail':true};function n(t){this.$LitestandStreamTailPager5=function(v){if(v.error){this.$LitestandStreamTailPager6('streamload_error.tail.final')}else{this.$LitestandStreamTailPager6('streamload.tail.success');this.numTailLoads++}}.bind(this);this.$LitestandStreamTailPager1=function(v){this.$LitestandStreamTailPager7(v)}.bind(this);this.$LitestandStreamTailPager2=function(v){this.$LitestandStreamTailPager6('streamload_error.tail.transport');this.$LitestandStreamTailPager7(v)}.bind(this);this.streamConfig=babelHelpers['extends']({bufferPixels:1000,firstPagerScrollBuffer:100,maxTailRetries:2,checkIfPagerIsCloseOnAttach:false},t.streamConfig);this.pagerConfig=t.pagerConfig;this.storiesContainer=t.storiesContainer;this.pagerElement=t.pagerElement;this.cursor=t.cursor;this.previousCursors={};this.retryCounter=0;this.numTailLoads=0;var u=c('DOM').find(this.pagerElement,'a');c('Event').listen(u,'click',this.$LitestandStreamTailPager3.bind(this))}n.prototype.$LitestandStreamTailPager3=function(event){this.$LitestandStreamTailPager4();event.preventDefault()};n.prototype.$LitestandStreamTailPager6=function(t){if(m[t])c('FunnelLogger').appendActionWithTag(h,this.numTailLoads,t,'try_'+this.retryCounter);c('Bootloader').loadModules(["BanzaiODS"],function(u){u&&u.bumpEntityKey('feed_load',t)},'LitestandStreamTailLoader')};n.prototype.$LitestandStreamTailPager7=function(t){delete this.previousCursors[this.cursor];c('Arbiter').inform(c('LitestandMessages').STREAM_LOAD_ERROR,t);this.$LitestandStreamTailPager6('streamload_error.tail');if(this.lastRequestWasRetry)this.$LitestandStreamTailPager6('streamload_error.tail.retry');if(this.retryCounter<this.streamConfig.maxTailRetries){this.retryCounter++;this.$LitestandStreamTailPager4(true);this.$LitestandStreamTailPager6('streamload.tail.retry');c('Arbiter').inform(c('LitestandMessages').STREAM_LOAD_RETRY);return}c('CSS').removeClass(this.pagerElement,'async_saving')};n.prototype.$LitestandStreamTailPager4=function(){var t=arguments.length<=0||arguments[0]===undefined?false:arguments[0];if(!t){c('FunnelLogger').startFunnel(h,this.numTailLoads);c('FunnelLogger').addFunnelTag(h,this.numTailLoads,'LitestandStreamTailLoader')}this.$LitestandStreamTailPager6('streamload.tail.commence');this.detach();c('CSS').addClass(this.pagerElement,'async_saving');var u=c('DOM').scry(c('LitestandStream').getStreamRoot(),c('LitestandStream').getStoriesSelector()).map(function(w){return w.getAttribute('data-cursor')}).filter(function(w){return w}),v=this.cursor;if(!v&&u.length>0)v=u[u.length-1];if(this.previousCursors[v]){this.$LitestandStreamTailPager6('duplicate_cursor');c('Arbiter').inform(c('LitestandMessages').DUPLICATE_CURSOR_ERROR,v)}this.previousCursors[v]=v;this.lastRequestWasRetry=t;c('Bootloader').loadModules(["UIPagelet"],function(w){w.loadFromEndpoint('LitestandTailLoadPagelet',c('getOrCreateDOMID')(this.storiesContainer),{client_stories_count:u.length,cursor:v,feed_stream_id:c('LitestandStream').getFeedStreamID(),pager_config:this.pagerConfig,scroll_count:this.numTailLoads+1,story_id:c('LitestandStream').getStoryID()},{append:true,automatic:true,constHeight:true,crossPage:true,errorHandler:this.$LitestandStreamTailPager1,finallyHandler:this.$LitestandStreamTailPager5,transportErrorHandler:this.$LitestandStreamTailPager2,usePipe:true});c('Arbiter').inform(c('LitestandMessages').STORIES_REQUESTED)}.bind(this),'LitestandStreamTailLoader')};n.prototype.$LitestandStreamTailPager8=function(t){var u=c('getUnboundedScrollPosition')(window).y;return u>t};n.prototype.$LitestandStreamTailPager9=function(){this.detach();this.onVisibleListener=new (c('OnVisible'))(c('DOM').find(this.pagerElement,'a'),function(){this.$LitestandStreamTailPager4()}.bind(this),false,this.streamConfig.bufferPixels)};n.prototype.attach=function(){var t,u=this,v=arguments.length<=0||arguments[0]===undefined?false:arguments[0];this.detach();var w=c('getElementPosition')(this.pagerElement),x=c('getViewportDimensions')();c('CSS').removeClass(this.pagerElement,'async_saving');if(w.y<x.height||this.streamConfig.checkIfPagerIsCloseOnAttach&&!this.numTailLoads&&w.y-this.streamConfig.bufferPixels<x.height){this.$LitestandStreamTailPager4();return}if(v){var t=function(){var y=Math.min(u.streamConfig.firstPagerScrollBuffer,w.y-x.height);if(!u.$LitestandStreamTailPager8(y)){u.onScrollListener=c('Event').listen(window,'scroll',c('throttle')(function(){if(this.$LitestandStreamTailPager8(y))this.$LitestandStreamTailPager9();}.bind(u)));u.onResizeListener=c('Event').listen(window,'resize',c('throttle')(function(){var z=c('getViewportDimensions')();if(w.y<z.height+y)this.$LitestandStreamTailPager4();}.bind(u)));return {v:void 0}}}();if(typeof t==="object")return t.v;}this.$LitestandStreamTailPager9()};n.prototype.detach=function(){this.onResizeListener&&this.onResizeListener.remove();this.onScrollListener&&this.onScrollListener.remove();this.onVisibleListener&&this.onVisibleListener.remove();this.onResizeListener=null;this.onScrollListener=null;this.onVisibleListener=null};n.prototype.remove=function(){this.detach();if(this.pagerElement)c('DOM').remove(this.pagerElement);};n.prototype.handleError=function(){this.$LitestandStreamTailPager7()};function o(){r();k&&k.release();k=null;j&&j.remove();j=null;c('Arbiter').inform(c('LitestandMessages').LEAVE_HOME)}function p(){this._log('streamload_timeout.tail')}function q(){r();i=setTimeout(p,l)}function r(){clearTimeout(i)}var s={createPager:function t(u){j&&j.remove();var v=new n(u);v.attach(true);c('ListestandStreamTailStoryPlaceholderVisbilityTracker').setPlaceholderElement(v.pagerElement);j=v;if(!k){k=new (c('SubscriptionsHandler'))();k.addSubscriptions(c('Arbiter').subscribe(c('NavigationMessage').NAVIGATION_BEGIN,o),c('Arbiter').subscribe(c('LitestandMessages').STORIES_REQUESTED,q),c('Arbiter').subscribe([c('LitestandMessages').STORIES_INSERTED,c('LitestandMessages').STREAM_LOAD_ERROR],r));c('Run').onLeave(o)}},updatePager:function t(u){var v=c('LitestandStream').getStreamRoot();if(v)c('NewsFeedDedupeStoryController').dedupe(v,c('LitestandStream').getStoriesSelector());if(j&&u&&u.cursor){j.cursor=u.cursor;j.attach()}else this._log('update_tail_cursor_error');},removePager:function t(){j&&j.remove();j=null},moreStoriesInserted:function t(u){c('Arbiter').inform(c('LitestandMessages').STORIES_INSERTED,{substream_id:u});var v=c('ge')(u);if(v){c('LitestandOffscreenController').attachSubstream(v);if(j&&j.lastRequestWasRetry){j.lastRequestWasRetry=false;j.retryCounter=0;this._log('streamload.tail.retry.success')}}},handleError:function t(){j&&j.handleError()}};f.exports=s}),null);
__d("PrivacySelectorEvent",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({OPEN_MENU:"open_menu",CLOSE_MENU:"close_menu",MORE_OPTIONS:"more_options",MORE:"more",SEE_ALL:"see_all",CUSTOM_SAVE:"custom_save",CUSTOM_CANCEL:"custom_cancel",SELECT_CUSTOM:"select_custom",SPECIFIC_FRIENDS_SAVE:"specific_friends_save",SPECIFIC_FRIENDS_CANCEL:"specific_friends_cancel",SELECT_SPECIFIC_FRIENDS:"select_specific_friends",FRIENDS_EXCEPT_SAVE:"friends_except_save",FRIENDS_EXCEPT_CANCEL:"friends_except_cancel",SELECT_FRIENDS_EXCEPT:"select_friends_except",SELECT_EVERYONE:"select_everyone",SELECT_FRIENDS_OF_FRIENDS:"select_friends_of_friends",SELECT_FRIENDS:"select_friends",SELECT_FRIENDS_EXCEPT_ACQUIANTANCES:"select_friends_except_acquaintances",SELECT_ONLY_ME:"select_only_me",SELECT_FB_ONLY:"select_fb_only",SELECT_FRIENDLIST:"select_friendlist",SELECT_OTHER:"select_other"})}),null);
__d('PrivacySelectorSelectableItem',['csx','cx','CSS','DOM','DOMQuery','MenuSelectableItem','React','SutroStoryHeaderUFIGatingConfig'],(function a(b,c,d,e,f,g,h,i){var j,k,l="._o00",m="._o01",n="._po2";j=babelHelpers.inherits(o,c('MenuSelectableItem'));k=j&&j.prototype;function o(p){'use strict';if(p.icon){var q=c('SutroStoryHeaderUFIGatingConfig').enabled_privacyicon,r="_392n"+(q?' '+"_1rwt":'');if(p.children){p.icon=c('React').createElement('div',{className:r},p.icon)}else p.icon=c('DOM').create('div',{className:r},p.icon);}k.constructor.call(this,p)}o.prototype.render=function(){'use strict';var p=k.render.call(this),q=c('DOMQuery').find(p,"._54nh");c('CSS').addClass(q,"_4chm");var r=q.parentNode;c('CSS').addClass(r,"_4chl");var s=c('DOMQuery').scry(p,"._392n")[0];if(!s)c('CSS').addClass(r,"_4857");return p};o.prototype.isMoreButton=function(){'use strict';return c('CSS').matchesSelector(this.getRoot(),l)};o.prototype.isMoreOptionsButton=function(){'use strict';return c('CSS').matchesSelector(this.getRoot(),n)};o.prototype.isSeeAllButton=function(){'use strict';return c('CSS').matchesSelector(this.getRoot(),m)};f.exports=o}),null);
__d('PrivacySelectorOptionNew',['csx','cx','fbt','CSS','DOM','DOMQuery','JSXDOM','PrivacyConst','PrivacySelectorEvent','PrivacySelectorSelectableItem'],(function a(b,c,d,e,f,g,h,i,j){var k,l;k=babelHelpers.inherits(m,c('PrivacySelectorSelectableItem'));l=k&&k.prototype;function m(n){'use strict';l.constructor.call(this,n);this._origLabel=this.getLabel();this._origTriggerLabel=this.getTriggerLabel()}m.prototype._getData=function(){'use strict';return this._data};m.prototype.getTooltip=function(){'use strict';return this._getData().tooltip};m.prototype.getPostParam=function(){'use strict';return this._getData().postParam.toString()};m.prototype.setPostParam=function(n){'use strict';this._getData().postParam=n;return this};m.prototype.getSubtitles=function(){'use strict';return this._data.optionSubtitles};m.prototype.setSubtitles=function(n){'use strict';if(this._data.optionSubtitles!=null)this._data.optionSubtitles=n;return this};m.prototype.getTriggerIcon=function(){'use strict';return this._getData().triggerIcon};m.prototype.getTriggerLabel=function(){'use strict';return this._getData().triggerLabel};m.prototype.isPublic=function(){'use strict';return this.getPostParam()===c('PrivacyConst').PostParam.EVERYONE.toString()};m.prototype.isFriendsOfFriends=function(){'use strict';return this.getPostParam()===c('PrivacyConst').PostParam.FRIENDS_OF_FRIENDS.toString()};m.prototype.isFriends=function(){'use strict';return this.getPostParam()===c('PrivacyConst').PostParam.FRIENDS.toString()};m.prototype.isFriendsExceptAcquaintances=function(){'use strict';return this.getPostParam()===c('PrivacyConst').PostParam.FRIENDS_MINUS_ACQUAINTANCES.toString()};m.prototype.isOnlyMe=function(){'use strict';return this.getPostParam()===c('PrivacyConst').PostParam.ONLY_ME.toString()};m.prototype.isFBOnly=function(){'use strict';return this.getPostParam()===c('PrivacyConst').PostParam.FB_ONLY.toString()};m.prototype.isFriendlist=function(){'use strict';return this._data.isFriendlist};m.prototype.isBasicOption=function(){'use strict';return true};m.prototype.isCustomOption=function(){'use strict';return false};m.prototype.isSavedCustomOption=function(){'use strict';return false};m.prototype.getSavedCustomPrivacyType=function(){'use strict';return null};m.prototype.getTagExpansionBehavior=function(){'use strict';return this._getData().tagExpansionBehavior};m.prototype.getBaseValue=function(){'use strict';return this._getData().baseValue};m.prototype.getIndex=function(){'use strict';return this._getData().value};m.prototype.getLoggingEventName=function(){'use strict';if(this.isPublic()){return c('PrivacySelectorEvent').SELECT_EVERYONE}else if(this.isFriendsOfFriends()){return c('PrivacySelectorEvent').SELECT_FRIENDS_OF_FRIENDS}else if(this.isFriends()){return c('PrivacySelectorEvent').SELECT_FRIENDS}else if(this.isFriendsExceptAcquaintances()){return c('PrivacySelectorEvent').SELECT_FRIENDS_EXCEPT_ACQUIANTANCES}else if(this.isOnlyMe()){return c('PrivacySelectorEvent').SELECT_ONLY_ME}else if(this.isFBOnly()){return c('PrivacySelectorEvent').SELECT_FB_ONLY}else if(this.isFriendlist()){return c('PrivacySelectorEvent').SELECT_FRIENDLIST}else return c('PrivacySelectorEvent').SELECT_OTHER;};m.prototype.updateAfterTagExpansion=function(n,o){'use strict';var p=this._origLabel,q=this._origTriggerLabel;if(n&&this._getData().showPlusOnTagExpansion){p=j._("{privacyLabel} (+)",[j.param('privacyLabel',p)]);if(o&&this.isFriends()){q=j._("Friends, friends of tagged")}else q=j._("{privacyLabel} (+)",[j.param('privacyLabel',q)]);}this._setLabel(p);this._getData().triggerLabel=q;var r=this._getExpansionType(n),s=this._getData().optionSubtitles||{};this._setSubtitle(s[r])};m.prototype.isBelowSoftFold=function(){'use strict';return c('CSS').matchesSelector(this.getRoot(),"._4mwj")};m.prototype.isBelowFold=function(){'use strict';return c('CSS').matchesSelector(this.getRoot(),"._3ey_")};m.prototype.removeOnBootload=function(){'use strict';return !!this._getData().removeOnBootload};m.prototype._setLabel=function(n){'use strict';if(!n)return;var o=c('DOMQuery').find(this.getRoot(),"._54nh");o&&c('DOM').setContent(o,n);this._getData().label=n};m.prototype._setSubtitle=function(n){'use strict';if(!n)return;var o=c('DOMQuery').scry(this.getRoot(),"._48u1");o&&o[0]&&c('DOM').setContent(o[0],n)};m.prototype._getExpansionType=function(n){'use strict';return n?c('PrivacyConst').ExpansionType.TAGS_ONLY:c('PrivacyConst').ExpansionType.NONE};m.prototype.render=function(){'use strict';var n=l.render.call(this);if(!this._getData().isPrimaryOption)return n;var o=c('DOMQuery').find(n,"._54nc");o&&c('CSS').addClass(o,"_48t_");var p=c('DOMQuery').scry(n,"._392n")[0];if(!p&&o)c('CSS').addClass(o,"_4zfs");var q=c('DOM').find(n,"._54nh");q&&c('CSS').addClass(q,"_48u0");var r=c('JSXDOM').div({className:"_48u1"},this._getData().optionSubtitle);c('DOM').appendContent(o,r);return n};f.exports=m}),null);
__d("XPrivacySelectorLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/privacy\/selector\/log\/",{event:{type:"Enum",required:true,enumType:1},render_location:{type:"Enum",required:true,enumType:1},content_type:{type:"String",required:true},privacy_fbid:{type:"String"},saved_custom_opt_in:{type:"Bool",defaultValue:false}})}),null);
__d('PrivacySelectorCustomOption',['invariant','AsyncDialog','AsyncRequest','DataStore','PrivacySelectorEvent','PrivacySelectorOptionNew','XPrivacyCustomDialogController','XPrivacySelectorLoggingController'],(function a(b,c,d,e,f,g,h){var i,j;i=babelHelpers.inherits(k,c('PrivacySelectorOptionNew'));j=i&&i.prototype;function k(l){'use strict';j.constructor.call(this,l);this._subtitlesWhenNotSelected=l.optionSubtitlesWhenNotSelected}k.prototype.isBasicOption=function(){'use strict';return false};k.prototype.isCustomOption=function(){'use strict';return true};k.prototype.getSelector=function(){'use strict';return this._selector};k.prototype.getLoggingEventName=function(){'use strict';return c('PrivacySelectorEvent').SELECT_CUSTOM};k.prototype.setSubtitlesToNonSelected=function(){'use strict';this.setSubtitles(this._subtitlesWhenNotSelected)};k.prototype.openDialog=function(l){'use strict';if(this._selector==null)this._selector=l;c('DataStore').set(this._data.id,'PrivacySelectorCustomOption',this);var m=c('XPrivacyCustomDialogController').getURIBuilder().setString('option_id',this._data.id).setString('id',this._data.privacyfbid.toString()).setString('post_param',l.getPostParam()).setString('content_type',l.getContentType()).setEnum('render_location_enum',l.getRenderLocation()).setIntVector('tags',l.getTags()).setBool('autosave',this._data.autosave).setBool('limit_community',this._data.limitcommunity).setBool('limit_facebook',this._data.limitfacebook).setBool('limit_fof',this._data.limitfof).setBool('limit_tagexpand',this._data.limittagexpand).setBool('is_new_privacy_selector',true).setBool('saved_custom_opt_in',l.getSavedCustomOptIn()).getURI(),n=new (c('AsyncRequest'))(m);n.setRelativeTo(l.getTriggerButtonElement());c('AsyncDialog').send(n,function(o){var p=function(q){var r=document.getElementsByName('render_location')[0];r instanceof HTMLInputElement||h(0);var s=document.getElementsByName('content_type')[0];s instanceof HTMLInputElement||h(0);var t=c('XPrivacySelectorLoggingController').getURIBuilder().setEnum('event',q).setString('privacy_fbid',this._data.privacyfbid!=null?String(this._data.privacyfbid):null).setEnum('render_location',r.value).setString('content_type',s.value).getURI();new (c('AsyncRequest'))().setURI(t).send()}.bind(this);o.subscribe('hide',function(){l.inform('custom/hide');l.inform('selectorFinished')});o.subscribe('success',function(){l.inform('custom/success');p(c('PrivacySelectorEvent').CUSTOM_SAVE)});o.subscribe('cancel',function(){l.inform('custom/cancel');p(c('PrivacySelectorEvent').CUSTOM_CANCEL)})}.bind(this))};k.customPrivacySave=function(l,m,n){var o=arguments.length<=3||arguments[3]===undefined?{}:arguments[3];'use strict';var p=c('DataStore').get(l,'PrivacySelectorCustomOption');c('DataStore').remove(l,'PrivacySelectorCustomOption');if(!(p==null))if(!(p.getSelector==null)){var q=p.getSelector();if(n!==null){q.updateSavedCustomOption(n,m,o)}else q.updateCustomOption(o);q.selectOption(m);q.finishAnimatingSavedCustomSave()}};f.exports=k}),null);
__d("XPrivacySelectorAsyncMoreController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/privacy\/selector\/async_more\/",{id:{type:"String",required:true},next_value:{type:"Int",required:true},render_location_enum:{type:"Enum",required:true,enumType:1}})}),null);
__d('PrivacySelectableMenu',['cx','Arbiter','AsyncRequest','CSS','DataStore','Ease','PrivacySelectorCustomOption','PrivacySelectorEvent','PrivacySelectorOptionNew','PrivacySelectorSelectableItem','SelectableMenu','SelectableMenuUtils','XPrivacySelectorAsyncMoreController','XPrivacySelectorLoggingController'],(function a(b,c,d,e,f,g,h){var i,j;i=babelHelpers.inherits(k,c('SelectableMenu'));j=i&&i.prototype;function k(l,m){'use strict';j.constructor.call(this,l,m);c('DataStore').set('PrivacySelectableMenu',m.id,this);this._needsBootload=!!m.needsbootload;this.collapseMenu();this.updateOptionsAfterTagExpansion(!!m.hasTags)}k.prototype.cleanup=function(){'use strict';c('DataStore').remove('PrivacySelectableMenu',this._config.id)};k.prototype.getItemForIndex=function(l){'use strict';return this.findOption(function(m){return m.getIndex()==l})};k.prototype.findItem=function(l){'use strict';for(var m=this._items,n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}var q=p;if(q instanceof c('PrivacySelectorSelectableItem')&&l(q))return q;}return null};k.prototype.findOption=function(l){'use strict';return this.findItem(function(m){return m instanceof c('PrivacySelectorOptionNew')&&l(m)})};k.prototype.getSelectedOption=function(){'use strict';return this.findOption(function(l){return l.isSelected()})};k.prototype.selectOption=function(l){'use strict';var m=null,n=false,o=false;for(var p=this._items,q=Array.isArray(p),r=0,p=q?p:p[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var s;if(q){if(r>=p.length)break;s=p[r++]}else{r=p.next();if(r.done)break;s=r.value}var t=s;if(!(t instanceof c('PrivacySelectorSelectableItem')))continue;if(t instanceof c('PrivacySelectorCustomOption')){m=t;continue}if(t.isMoreButton()){this.expandMenuWithMore();continue}if(t.isMoreOptionsButton()||t.isSeeAllButton()){if(this._needsBootload){n=true}else this.expandMenu();continue}if(!n&&t instanceof c('PrivacySelectorOptionNew')&&t.getPostParam()==l){this.setValue(t.getIndex());o=true;break}}if(!o&&m){m.setPostParam(l);this.setValue(m.getIndex())}if(n){this.subscribeOnce('expandMenu',function(){this.selectOption(l)}.bind(this));this.expandMenu()}else this.inform('selectOption');return !n};k.prototype._handleItemClick=function(l,m){'use strict';if(!c('SelectableMenuUtils').doesItemSupportSelect(l))return j._handleItemClick.call(this,l,m);if(l.isMoreButton()){this._logMoreButtonClick();this.expandMenuWithMore();return undefined}if(l.isMoreOptionsButton()||l.isSeeAllButton()){this._logMoreOptionsOrSeeAllButtonClick();this.expandMenu();return undefined}if(!(l instanceof c('PrivacySelectorOptionNew')))return undefined;this._logOptionClick(l);var n=this.inform('itemclick',{item:l,event:m});if(n)return undefined;if(!c('SelectableMenuUtils').isSelected(l)&&!l.isCustomOption()&&!l.isSavedCustomOption()&&l.select()!==false){this._items.forEach(function(o){if(c('SelectableMenuUtils').isSelected(o)&&o!==l)o.deselect();});this.inform('change',this.getSelection())}c('Arbiter').inform('composerprivacy/aborteducation');this.done();return l.handleClick()};k.prototype._logMoreButtonClick=function(){'use strict';var l=c('XPrivacySelectorLoggingController').getURIBuilder().setString('content_type',this._config.contenttype).setEnum('event',c('PrivacySelectorEvent').MORE).setString('privacy_fbid',this._config.privacyfbid!=null?String(this._config.privacyfbid):null).setEnum('render_location',this._config.renderlocation).setBool('saved_custom_opt_in',this._config.savedCustomOptIn).getURI();new (c('AsyncRequest'))().setURI(l).send()};k.prototype._logMoreOptionsOrSeeAllButtonClick=function(){'use strict';var event=this._config.hasSavedCustom?c('PrivacySelectorEvent').SEE_ALL:c('PrivacySelectorEvent').MORE_OPTIONS,l=c('XPrivacySelectorLoggingController').getURIBuilder().setString('content_type',this._config.contenttype).setEnum('event',event).setString('privacy_fbid',this._config.privacyfbid!=null?String(this._config.privacyfbid):null).setEnum('render_location',this._config.renderlocation).setBool('saved_custom_opt_in',this._config.savedCustomOptIn).getURI();new (c('AsyncRequest'))().setURI(l).send()};k.prototype._logOptionClick=function(l){'use strict';var m=c('XPrivacySelectorLoggingController').getURIBuilder().setString('content_type',this._config.contenttype).setEnum('event',l.getLoggingEventName()).setString('privacy_fbid',this._config.privacyfbid!=null?String(this._config.privacyfbid):null).setEnum('render_location',this._config.renderlocation).setBool('saved_custom_opt_in',this._config.savedCustomOptIn).getURI();new (c('AsyncRequest'))().setURI(m).send()};k.prototype._getMoreOptionsOrSeeAllButton=function(){'use strict';return this.findItem(function(l){return l.isMoreOptionsButton()||l.isSeeAllButton()})};k.prototype.getCustomItem=function(){'use strict';return this.findOption(function(l){return l instanceof c('PrivacySelectorCustomOption')})};k.prototype._setMenuState=function(l){'use strict';var m=this.getRoot();c('CSS').conditionClass(m,"_po3",l!=='expanded');c('CSS').conditionClass(m,"_po4",l==='expanded');if(this._config.hasSavedCustom){c('CSS').conditionClass(m,"_n_v",l==='collapsed');c('CSS').conditionClass(m,"_n__",l!=='collapsed')}this._expanded=l==='expanded'};k.prototype.expandMenuWithMore=function(){'use strict';this._setMenuState('withMore');this.inform('expandMenuWithMore')};k.prototype.expandMenu=function(){'use strict';if(this._expanded)return;this._setMenuState('withMore');this._expanded=true;if(!this._needsBootload){this.expandMenuAfterLoaded();return}this._needsBootload=false;var l=this._getMoreOptionsOrSeeAllButton();if(l){this._moreOptionsIcon=l.getIcon();l.setIcon(this._config.morespinner);this._scrollToOption(l)}var m=Date.now(),n=c('XPrivacySelectorAsyncMoreController').getURIBuilder().setString('id',this._config.id).setInt('next_value',this._config.nextvalue).setEnum('render_location_enum',this._config.renderlocation).getURI();new (c('AsyncRequest'))().setURI(n).setRelativeTo(this.getRoot()).setErrorHandler(function(o){var p=1250-(Date.now()-m);setTimeout(function(){l&&l.setIcon(this._moreOptionsIcon);this._needsBootload=true;this._expanded=false}.bind(this),p>0&&l?p:0)}.bind(this)).send()};k.prototype.expandMenuAfterLoaded=function(){'use strict';this._setMenuState('expanded');if(this._moreOptionsIcon){var l=this._getMoreOptionsOrSeeAllButton();l&&l.setIcon(this._moreOptionsIcon);this._moreOptionsIcon=undefined}this.inform('expandMenu')};k.prototype.collapseMenu=function(){'use strict';this._setMenuState('collapsed')};k.prototype.updateOptionsAfterTagExpansion=function(l){'use strict';this._lastHasTagsUpdate=l;this.forEachItem(function(m){if(m instanceof c('PrivacySelectorOptionNew'))m.updateAfterTagExpansion(l,!!this._config.hasSimpleLabels);}.bind(this))};k.prototype.refreshTagExpansionLabels=function(){'use strict';this.updateOptionsAfterTagExpansion(!!this._lastHasTagsUpdate)};k.prototype.updateTagExpansionLabelAfterBootload=function(){'use strict';this.refreshTagExpansionLabels()};k.prototype.onPopoverOpen=function(l){'use strict';if(l&&l.isBelowFold()){if(this._needsBootload){this.subscribeOnce('expandMenu',function(){var m=this.getSelectedOption();m&&this._scrollToOption(m)}.bind(this))}else this._scrollToOption(l);this.expandMenu()}else if(l&&l.isBelowSoftFold()){this.expandMenuWithMore();this._scrollToOption(l)}else this.collapseMenu();};k.prototype._scrollToOption=function(l){'use strict';if(!this._scrollableArea)return;var m=l.getRoot();if(m===null)return;var n=12,o=this._scrollableArea.getScrollTop(),p=o+this._scrollableArea.getClientHeight(),q=m.offsetTop+m.offsetHeight;if(q+n>p)this._scrollableArea.setScrollTop(o+q+n-p,true,{duration:Math.min(1000,(q+n-p)*10),ease:c('Ease').sineOut});};f.exports=k}),null);
__d('PopoverButton',['csx','DOM','DOMQuery','isTextNode'],(function a(b,c,d,e,f,g,h){var i={setLabel:function j(k,l){var m=c('DOMQuery').find(k,"._55pe"),n=m.childNodes;for(var o=0;o<n.length;o++)if(c('isTextNode')(n[o])){c('DOM').replace(n[o],l);return}c('DOM').appendContent(m,l)}};f.exports=i}),null);
__d('PrivacySelectorDataStore',['ArbiterMixin','PrivacySelectorNewDispatcher','KeyedCallbackManager'],(function a(b,c,d,e,f,g){var h=new (c('KeyedCallbackManager'))(),i=babelHelpers['extends']({},c('ArbiterMixin'),{get:function j(k,l){h.executeOrEnqueue(k,l)},hasValueChanged:function j(k){return !!h.getResource(k)}});c('PrivacySelectorNewDispatcher').register(function(j){if(j.saved_custom_privacy_type!=null){h.addResourcesAndExecute({saved_custom_update:{postParam:j.post_param,savedCustomPrivacyType:j.saved_custom_privacy_type,sourceSelectorID:j.unique_id,subtitles:j.subtitles}});i.inform('saved_custom_update')}if(j.selector_type){var k={};k[j.selector_type]={post_param:j.post_param,unique_id:j.unique_id,reload:j.reload,is_error:j.is_error,is_custom:j.is_custom,selector_type:j.selector_type,subtitles:j.subtitles};h.addResourcesAndExecute(k);i.inform('change')}});f.exports=i}),null);
__d("SavedCustomPrivacyType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({SPECIFIC_FRIENDS:"specific_friends",FRIENDS_EXCEPT:"friends_except"})}),null);
__d("XPrivacySpecificAudienceSelectorDialogController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/privacy\/specific_audience_selector_dialog\/",{autosave:{type:"Bool",defaultValue:false},content_type:{type:"String"},fbid:{type:"String",required:true},option_id:{type:"String"},post_param:{type:"String"},privacy_type:{type:"Enum",required:true,enumType:1},render_location:{type:"Enum",required:true,enumType:1},return_uri:{type:"String"},cancel_uri:{type:"String"}})}),null);
__d('PrivacySelectorSavedCustomOption',['AsyncDialog','AsyncRequest','DataStore','PrivacySelectorEvent','PrivacySelectorOptionNew','SavedCustomPrivacyType','XPrivacySpecificAudienceSelectorDialogController'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('PrivacySelectorOptionNew'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this,k)}j.prototype.getSelector=function(){'use strict';return this._selector};j.prototype.isBasicOption=function(){'use strict';return false};j.prototype.isSavedCustomOption=function(){'use strict';return true};j.prototype.getSavedCustomPrivacyType=function(){'use strict';return this._data.savedCustomPrivacyType};j.prototype.getLoggingEventName=function(){'use strict';switch(this._data.savedCustomPrivacyType){case c('SavedCustomPrivacyType').FRIENDS_EXCEPT:return c('PrivacySelectorEvent').SELECT_FRIENDS_EXCEPT;case c('SavedCustomPrivacyType').SPECIFIC_FRIENDS:return c('PrivacySelectorEvent').SELECT_SPECIFIC_FRIENDS;default:return c('PrivacySelectorEvent').SELECT_OTHER;}};j.prototype.openDialog=function(k){'use strict';this._selector=k;c('DataStore').set(this._data.id,'PrivacySelectorCustomOption',this);var l=c('XPrivacySpecificAudienceSelectorDialogController').getURIBuilder().setBool('autosave',this._data.autosave).setString('content_type',k.getContentType()).setString('fbid',this._data.privacyFBID).setString('option_id',this._data.id).setString('post_param',this.getPostParam()).setEnum('privacy_type',this._data.savedCustomPrivacyType).setEnum('render_location',k.getRenderLocation()).getURI(),m=new (c('AsyncRequest'))().setURI(l).setRelativeTo(k.getTriggerButtonElement());c('AsyncDialog').send(m)};j.informSave=function(k){'use strict';var l=c('DataStore').get(k,'PrivacySelectorCustomOption');if(l instanceof j){var m=l.getSelector();m&&m.animateSavedCustomSave()}};f.exports=j}),null);
__d("XPrivacySelectorSavedCustomUpdateController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/privacy\/selector\/update\/saved_custom\/",{})}),null);
__d("XPrivacySelectorUpdateController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/privacy\/selector\/update\/",{privacy_fbid:{type:"String",required:true},post_param:{type:"String",required:true},tags:{type:"IntVector"},render_location_enum:{type:"Enum",required:true,enumType:1},is_saved_on_select:{type:"Bool",defaultValue:false},should_return_tooltip:{type:"Bool",defaultValue:false},replace_on_select:{type:"Bool",defaultValue:false},prefix_tooltip_with_app_privacy:{type:"Bool",defaultValue:false},ent_id:{type:"String",required:true},reload_selector:{type:"Bool",defaultValue:false}})}),null);
__d('PrivacySelectorBase',['cx','fbt','Promise','regeneratorRuntime','Animation','Arbiter','ArbiterMixin','AsyncRequest','Button','CSS','CurrentUser','DataStore','DOM','Focus','Input','MenuStaticItem','PopoverButton','PopoverLoadingMenu','PrivacyConst','PrivacySelectableMenu','PrivacySelectorCustomOption','PrivacySelectorDataStore','PrivacySelectorEvent','PrivacySelectorNewDispatcher','PrivacySelectorSavedCustomOption','Run','SubscriptionsHandler','TooltipData','XPrivacySelectorLoggingController','XPrivacySelectorSavedCustomUpdateController','XPrivacySelectorUpdateController','XUIError','$','bind','debounce','ge','mixin'],(function a(b,c,d,e,f,g,h,i){var j,k;j=babelHelpers.inherits(l,c('mixin')(c('ArbiterMixin')));k=j&&j.prototype;function l(m,n,o,p,q,r){'use strict';k.constructor.call(this);this._hasBeenCleanedUp=false;this._syncUpdateQueue=[];this._isWaitingForSavedCustom=false;this._config=r;c('DataStore').set(this._config.rootID,'selector',this);this._isSavedOnSelect=r.is_saved_on_select;this._privacyFBID=r.privacy_fbid;this._contentType=r.content_type;this._renderLocation=r.render_location;this._supportsTagExpansion=r.supports_tag_expansion;this._skipCleanup=r.skip_cleanup;this._prefixTooltipApps=r.should_prefix_tooltip_apps;this._shouldDisplayLabel=r.should_display_label;this._tags=r.tagged_uids;this._hasTags=this._tags.length>0;this._entID=r.ent_id;this._receivingUpdate=false;this._selectorSyncKey=r.selector_sync_key;this._previousParam=null;this._listeners=new (c('SubscriptionsHandler'))();this._spinnerCount=0;this._postParam=r.postParam;if(r.use_async_menu){this._listeners.addSubscriptions(this.getPopoverMenu().subscribe('setMenu',function(){this._menu=this.getPopoverMenu().getMenu();if(!(this._menu instanceof c('PrivacySelectableMenu')))return;this._onMenuLoad();this._onPopoverOpen();this.inform('asyncMenuLoaded')}.bind(this)))}else this._onMenuLoad();if(this._selectorSyncKey||this._config.hasSavedCustomPrivacy)this._initSelectorSync();c('Run').onLeave(this._cleanup.bind(this))}l.prototype._cleanup=function(){'use strict';if(this._skipCleanup)return;var m=this.getSelectableMenu();if(m instanceof c('PrivacySelectableMenu'))m.cleanup();this._hasBeenCleanedUp=true;this._syncUpdateQueue=[];this._syncUpdatePromise=null;this._listeners&&this._listeners.release();this._listeners=null};l.prototype._initSelectorSync=function(){'use strict';if(this._selectorSyncKey)this._listeners&&this._listeners.addSubscriptions(c('PrivacySelectorDataStore').subscribe('change',function(){if(this._selectorSyncKey==null)return;c('PrivacySelectorDataStore').get(this._selectorSyncKey,function(m){this._enqueueAndExecuteSyncUpdate({type:'regular_update',payload:m})}.bind(this))}.bind(this)));if(this._config.hasSavedCustomPrivacy)this._listeners&&this._listeners.addSubscriptions(c('PrivacySelectorDataStore').subscribe('saved_custom_update',function(){c('PrivacySelectorDataStore').get('saved_custom_update',function(m){this._enqueueAndExecuteSyncUpdate({type:'saved_custom_update',payload:m})}.bind(this))}.bind(this)));};l.prototype._enqueueAndExecuteSyncUpdate=function(m){'use strict';this._syncUpdateQueue.push(m);if(this._syncUpdatePromise)return;this._syncUpdatePromise=this._startSyncUpdates();this._syncUpdatePromise.done(function(){this._syncUpdatePromise=null}.bind(this))};l.prototype._startSyncUpdates=function(){'use strict';return new (c('Promise'))(function m(n,o){var p;return c('regeneratorRuntime').async(function q(r){while(1)switch(r.prev=r.next){case 0:r.next=2;return c('regeneratorRuntime').awrap(this._waitUntilSelectorInDOM());case 2:if(!this._hasBeenCleanedUp){r.next=5;break}o();return r.abrupt('return');case 5:while(this._syncUpdateQueue.length){p=this._syncUpdateQueue.shift();this._executeSyncUpdate(p)}n();case 7:case 'end':return r.stop();}},null,this)}.bind(this))};l.prototype._executeSyncUpdate=function(m){'use strict';if(m.type==='tags_changed'){this._executeTagsChangedUpdate(m.tags);return}var n=m.payload,o=this.getSelectableMenu();if(n.unique_id===o._config.id)return;this._receivingUpdate=true;switch(m.type){case 'regular_update':c('XUIError').clear(this.getTriggerButtonElement());if(n.post_param)this.selectOption(n.post_param,function(){if(n.is_custom&&n.subtitles)this.updateCustomOption(n.subtitles);}.bind(this));n.reload&&this.reloadSelector();n.is_error&&this._displayErrorWithoutFocus();if(!n.post_param)this._receivingUpdate=false;break;case 'saved_custom_update':if(o instanceof c('PrivacySelectableMenu')&&n.savedCustomPrivacyType!=null&&n.postParam!=null&&n.subtitles!=null)this.updateSavedCustomOption(n.savedCustomPrivacyType,n.postParam,n.subtitles);if(!this.shouldTryToUpdateSavedCustom())return;l._savedCustomSelectorsToUpdate.push(this);l._sendSavedCustomUpdateRequest();if(!n.postParam)this._receivingUpdate=false;break;}};l.prototype._executeTagsChangedUpdate=function(m){'use strict';var n=!m.length;if(this._hasTags===n){this._hasTags=!!m.length;this.getSelectableMenu().updateOptionsAfterTagExpansion(this._showTagExpansion());this._updateTriggerButtonLabelAndIcon()}if(this._tags.length!==m.length||m.some(function(o){return !this._tags.includes(o)}.bind(this))){this._tags=m;this._updateTooltip();c('Arbiter').inform('PrivacySelectorBase/changed',this._getChangedData())}};l.prototype.shouldTryToUpdateSavedCustom=function(){'use strict';if(this.getSelectableMenu() instanceof c('PrivacySelectableMenu'))return this.getIsCustomOptionSelected()||this.getIsSavedCustomOptionSelected();for(var m=Object.keys(c('PrivacyConst').PostParam),n=Array.isArray(m),o=0,m=n?m:m[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var p;if(n){if(o>=m.length)break;p=m[o++]}else{o=m.next();if(o.done)break;p=o.value}var q=p;if(this._postParam===c('PrivacyConst').PostParam[q].toString())return false;}return true};l.prototype._broadcastUpdate=function(){'use strict';this._broadcastUpdateImpl(false)};l.prototype._broadcastError=function(){'use strict';this._broadcastUpdateImpl(true)};l.prototype._broadcastUpdateImpl=function(m){'use strict';if(!this._receivingUpdate){var n={};n.selector_type=this._selectorSyncKey;n.unique_id=this.getSelectableMenu()._config.id;if(m){n.is_error=m}else{var o=this._getSelectedOption();if(!o)return;n.post_param=o.getPostParam();n.subtitles=o.getSubtitles();n.is_custom=o.isCustomOption();n.saved_custom_privacy_type=o.getSavedCustomPrivacyType()}c('PrivacySelectorNewDispatcher').handleUpdateFromSelector(n)}};l.prototype.disable=function(){'use strict';var m=this.getTriggerButtonElement();c('Button').setEnabled(m,false);this.getPopover().disable();c('CSS').addClass(m,"_4swv");return this};l.prototype.enable=function(){'use strict';var m=this.getTriggerButtonElement();c('Button').setEnabled(m,true);this.getPopover().enable();c('CSS').removeClass(m,"_4swv");return this};l.prototype.shouldReplaceOnPost=function(){'use strict';return this._config.replace_on_post};l.prototype.getSelectedTriggerIcon=function(){'use strict';return this._selectedOption&&this._selectedOption.getTriggerIcon()};l.prototype.getSelectedTriggerLabel=function(){'use strict';return this._selectedOption&&this._selectedOption.getTriggerLabel()};l.prototype.getIsPublicSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isPublic()};l.prototype.getIsFriendsSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isFriends()};l.prototype.getIsOnlyMeSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isOnlyMe()};l.prototype.getSelectedBaseValue=function(){'use strict';return this._selectedOption&&this._selectedOption.getBaseValue()};l.prototype.getSelectedLabelString=function(){'use strict';return this._selectedOption&&this._selectedOption.getLabel()};l.prototype.getSelectedPostParam=function(){'use strict';return this._selectedOption&&this._selectedOption.getPostParam()};l.prototype.getIsCustomOptionSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isCustomOption()};l.prototype.getIsSavedCustomOptionSelected=function(){'use strict';return this._selectedOption&&this._selectedOption.isSavedCustomOption()};l.prototype.getIsSavedOnSelect=function(){'use strict';return this._isSavedOnSelect};l.prototype.getPrivacyFBID=function(){'use strict';return this._privacyFBID};l.prototype.setValue=function(m){'use strict';this.getSelectableMenu().setValue(m)};l.prototype.setIsSavedOnSelect=function(m){'use strict';this._isSavedOnSelect=m};l.prototype.getSavedCustomOptIn=function(){'use strict';return this._config.savedCustomOptIn};l.prototype.openSelectorExpanded=function(m){'use strict';this.openSelector(function(){this.getSelectableMenu().expandMenu();m&&m()}.bind(this))};l.prototype.openSelector=function(m){'use strict';if(this.getSelectableMenu() instanceof c('PopoverLoadingMenu')){this.subscribeOnce('asyncMenuLoaded',function(){m&&m()});this.getPopover().showLayer()}else{this.getPopover().showLayer();m&&m()}};l.prototype.closeSelector=function(){'use strict';this.getPopover().hideLayer()};l.prototype.getSelectableMenu=function(){'use strict';if(!this._menu)this._menu=this._config.getMenu();return this._menu};l.prototype.getPopover=function(){'use strict';if(!this._popover)this._popover=this.getPopoverMenu().getPopover();return this._popover};l.prototype.getPopoverMenu=function(){'use strict';if(!this._popoverMenu)this._popoverMenu=this._config.getPopoverMenu();return this._popoverMenu};l.prototype.getTriggerButtonElement=function(){'use strict';if(!this._button)this._button=c('$')(this._config.buttonID);return this._button};l.prototype.isSelectorInDOM=function(){'use strict';return !!c('ge')(this._config.rootID)};l.prototype._waitUntilSelectorInDOM=function m(){return c('regeneratorRuntime').async(function n(o){while(1)switch(o.prev=o.next){case 0:'use strict';case 1:if(!(!this._hasBeenCleanedUp&&!this.isSelectorInDOM())){o.next=6;break}o.next=4;return c('regeneratorRuntime').awrap(new (c('Promise'))(function(p){return setTimeout(p,1000)}));case 4:o.next=1;break;case 6:case 'end':return o.stop();}},null,this)};l.prototype.getRoot=function(){'use strict';if(!this._root)this._root=c('$')(this._config.rootID);return this._root};l.prototype.getInput=function(){'use strict';if(!this._input)this._input=c('$')(this._config.inputID);return this._input};l.prototype.getSpinner=function(){'use strict';if(!this._spinner)this._spinner=c('$')(this._config.spinnerID);return this._spinner};l.prototype.getCheckmark=function(){'use strict';if(!this._checkmark)this._checkmark=c('$')(this._config.checkmarkID);return this._checkmark};l.prototype.getErrorIcon=function(){'use strict';if(!this._errorIcon)this._errorIcon=c('$')(this._config.errorIconID);return this._errorIcon};l.prototype.getMenuElement=function(){'use strict';return this.getSelectableMenu().getRoot()};l.prototype.selectOption=function(m,n){'use strict';if(!m)return;var o=this.getSelectableMenu();if(o instanceof c('PopoverLoadingMenu')){this.subscribeOnce('asyncMenuLoaded',this._selectOptionImpl.bind(this,m,n));this._fetchAsyncMenu()}else this._selectOptionImpl(m,n);};l.prototype._selectOptionImpl=function(m,n){'use strict';var o=this.getSelectableMenu(),p=o.selectOption(m);if(!p){o.subscribeOnce('selectOption',function(){var q=this.getIsSavedOnSelect();this.setIsSavedOnSelect(false);this._updateMenu();this.setIsSavedOnSelect(q);this._finishSpinnerSuccess();n&&n()}.bind(this));this._showSpinner()}else n&&n();this._updateMenu()};l.prototype._updateMenu=function(){'use strict';this._selectedOption=this._getSelectedOption();if(!this._selectedOption)return;this.updateDataForItemIndex(this._selectedOption.getIndex(),this._selectedOption.getPostParam())};l.prototype._fetchAsyncMenu=function(){'use strict';if(this._config.use_async_menu)this.getPopoverMenu().fetchMenu();};l.prototype._getSelectedOption=function(){'use strict';var m=this.getSelectableMenu();return m instanceof c('PrivacySelectableMenu')?m.getSelectedOption():null};l.prototype._onItemClick=function(m,n){'use strict';var o=n.item;if(o instanceof c('MenuStaticItem'))return;if(o.isBasicOption()){this.updateDataForItemIndex(o.getIndex(),o.getPostParam())}else if(o.isCustomOption()||o.isSavedCustomOption()){this._closeForCustom=true;o.openDialog(this)}this.inform('click',{customSelected:o.isCustomOption()})};l.prototype.getContentType=function(){'use strict';return this._contentType};l.prototype.getRenderLocation=function(){'use strict';return this._renderLocation};l.prototype.getPostParam=function(){'use strict';return this._postParam};l.prototype.getTags=function(){'use strict';return this._tags};l.prototype.updateCustomOption=function(m){'use strict';var n=this.getSelectableMenu(),o=n.findOption(function(p){return p instanceof c('PrivacySelectorCustomOption')});if(o==null)return;o.setSubtitles(m);n.refreshTagExpansionLabels()};l.prototype.updateSavedCustomOption=function(m,n,o){'use strict';var p=this.getSelectableMenu(),q=p.findOption(function(r){return r instanceof c('PrivacySelectorSavedCustomOption')&&r.getSavedCustomPrivacyType()===m});if(q==null)return;q.setPostParam(n).setSubtitles(o);p.refreshTagExpansionLabels()};l.prototype.updateDataForItemIndex=function(m,n){'use strict';var o=this.getSelectableMenu(),p=o.getItemForIndex(String(m));if(!p)return;if(p.isCustomOption()||p.isSavedCustomOption())p.setPostParam(n);if(!p.isCustomOption()){var q=o.findOption(function(r){return r instanceof c('PrivacySelectorCustomOption')});if(q!=null){q.setSubtitlesToNonSelected();o.refreshTagExpansionLabels()}}this._selectedOption=p;this._previousParam=this._postParam;this._postParam=n;c('Input').setValue(this.getInput(),n);this._updateTriggerButtonLabelAndIcon();this._updateTooltipAndSavePrivacyIfNeeded();this.inform('changed',{post_param:this._postParam,base_value:this.getSelectedBaseValue()})};l.prototype._shouldUpdateTooltips=function(){'use strict';return this._prefixTooltipApps||this._supportsTagExpansion&&this._hasTags||this.getIsCustomOptionSelected()||this.getIsSavedCustomOptionSelected()};l.prototype._updateTooltip=function(){'use strict';this._updateTooltipAndSavePrivacyIfNeededImpl(false)};l.prototype._updateTooltipAndSavePrivacyIfNeeded=function(){'use strict';this._updateTooltipAndSavePrivacyIfNeededImpl(true)};l.prototype._updateTooltipAndSavePrivacyIfNeededImpl=function(m){'use strict';if(this._shouldUpdateTooltips())this._updateTooltipToLoading();this._sendUpdateRequest(m);if(!this._shouldUpdateTooltips())this._setTooltipValue(this._selectedOption.getTooltip());};l.prototype.reloadSelector=function(){'use strict';this._cleanup();var m=c('XPrivacySelectorUpdateController').getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setEnum('render_location_enum',this._renderLocation).setBool('reload_selector',true).setString('ent_id',String(this._entID)).getURI();new (c('AsyncRequest'))().setRelativeTo(this.getRoot()).setHandler(this.inform.bind(this,'reloaded')).setURI(m).send()};l.prototype._sendUpdateRequest=function(m){'use strict';m=m&&this._isSavedOnSelect&&!this._receivingUpdate;var n=this._shouldUpdateTooltips();if(!m&&!n){this._receivingUpdate=false;return}m&&this._showSpinner();var o=c('XPrivacySelectorUpdateController').getURIBuilder().setString('privacy_fbid',String(this._privacyFBID)).setString('post_param',this._postParam).setIntVector('tags',this._tags).setEnum('render_location_enum',this._renderLocation).setBool('is_saved_on_select',m).setBool('should_return_tooltip',n).setBool('prefix_tooltip_with_app_privacy',this._prefixTooltipApps).setBool('replace_on_select',this._config.replace_on_select).setString('ent_id',String(this._entID)).getURI();if(this._updateRequest)this._updateRequest.abandon();this._updateRequest=new (c('AsyncRequest'))(o).setRelativeTo(this.getRoot()).setHandler(function(p){if(m){this._finishSpinnerSuccess();this._broadcastUpdate()}if(this._config.replace_on_select)this._cleanup();var q=p&&p.payload&&p.payload.tooltip;q&&this._setTooltipValue(p.payload.tooltip);this.inform('selector_updated')}.bind(this)).setFinallyHandler(function(p){this._receivingUpdate=false;this._updateRequest=null}.bind(this));if(m)this._updateRequest.setErrorHandler(c('bind')(this,function(p){if(this._receivingUpdate){this._displayErrorWithoutFocus();return}this.getSelectableMenu().selectOption(this._previousParam);this._postParam=this._previousParam;this._displayError();this._broadcastError()}));this._updateRequest.send()};l.prototype.animateSavedCustomSave=function(){'use strict';if(this._isWaitingForSavedCustom)return;this._showSpinner();this._updateTooltipToLoading();if(this._shouldDisplayLabel)this._updateTriggerToLoading();this._isWaitingForSavedCustom=true};l.prototype.finishAnimatingSavedCustomSave=function(){'use strict';if(!this._isWaitingForSavedCustom)return;this._finishSpinnerSuccess();this._isWaitingForSavedCustom=false};l.prototype._showSpinner=function(){'use strict';if(!this._shouldDisplaySuccessAndFailure())return;if(!this.getIsSavedOnSelect())return;if(this._spinnerCount===0){var m=this.getTriggerButtonElement(),n=this.getSpinner();c('XUIError').clear(m);c('Button').setIcon(m,n);c('CSS').show(n);c('CSS').hide(this.getCheckmark())}this._spinnerCount++};l.prototype._finishSpinnerSuccess=function(){var m,n=this;'use strict';if(!this._shouldDisplaySuccessAndFailure())return;if(!this.getIsSavedOnSelect())return;this._spinnerCount--;if(this._spinnerCount===0){c('CSS').hide(this.getSpinner());this._updateTriggerButtonLabelAndIcon();var o=this.getCheckmark();if(o)(function(){var p=n.getTriggerButtonElement(),q=c('Button').getIcon(p);c('Button').setIcon(p,o);c('CSS').hide(q);new (c('Animation'))(o).show().from('opacity',0).to('opacity',1).duration(400).checkpoint().duration(200).checkpoint().from('opacity',1).to('opacity',0).duration(400).hide().ondone(function(){this._updateTriggerButtonLabelAndIcon();new (c('Animation'))(q).show().from('opacity',0).to('opacity',1).duration(300).go()}.bind(n)).go()})();}};l.prototype._displayError=function(){'use strict';if(!this._shouldDisplaySuccessAndFailure())return;this._spinnerCount--;this._displayErrorImpl(true)};l.prototype._displayErrorWithoutFocus=function(){'use strict';this._displayErrorImpl(false)};l.prototype._displayErrorImpl=function(m){'use strict';if(!this._shouldDisplaySuccessAndFailure())return;var n=this.getTriggerButtonElement(),o=this.getErrorIcon();c('PopoverButton').setLabel(n,i._("Select audience"));c('Button').setIcon(n,o);c('CSS').show(o);c('TooltipData').remove(n);m&&c('Focus').setWithoutOutline(n);c('XUIError').set({target:n,message:i._("Your selection might not have been saved. We recommend trying again later.")})};l.prototype.informTagsChanged=function(m){'use strict';var n=this._getTags(m);this.informTagsChangedWithIDs(n)};l.prototype.informTagsChangedWithIDs=function(m){'use strict';this._enqueueAndExecuteSyncUpdate({type:'tags_changed',tags:m})};l.prototype._getChangedData=function(){'use strict';return {tags:this._tags,privacy:this.getSelectedBaseValue()}};l.prototype._showTagExpansion=function(){'use strict';return this._hasTags};l.prototype._getTags=function(m){'use strict';var n=[],o=c('CurrentUser').getID();if(m.withTags)for(var p=0;p<m.withTags.length;p++){var q=m.withTags[p].info;if(q.uid!=o)n.push(q.uid.toString());}if(m.mention)for(var r in m.mention)if(m.mention[r].type=='user'&&m.mention[r].uid!=o)n.push(m.mention[r].uid.toString());return n};l.prototype._updateTriggerButtonLabelAndIcon=function(){'use strict';if(this._shouldDisplaySuccessAndFailure()&&this._spinnerCount===0){var m=this.getTriggerButtonElement(),n=this._selectedOption.getTriggerIcon();if(this._config.trigger_no_icon)c('CSS').hide(n);c('Button').setIcon(m,n.cloneNode());c('CSS').conditionClass(c('Button').getIcon(m),"_21or",this.getIsPublicSelected())}if(!this._shouldDisplayLabel)return;if(!this._isWaitingForSavedCustom)c('PopoverButton').setLabel(this.getTriggerButtonElement(),this._selectedOption.getTriggerLabel());};l.prototype._getLoadingText=function(){'use strict';return i._("Loading...")};l.prototype._updateTooltipToLoading=function(){'use strict';this._setTooltipValue(this._getLoadingText())};l.prototype._updateTriggerToLoading=function(){'use strict';c('PopoverButton').setLabel(this.getTriggerButtonElement(),this._getLoadingText())};l.prototype._setTooltipValue=function(m){'use strict';m&&c('TooltipData').set(this.getTriggerButtonElement(),m)};l.prototype._onPopoverClose=function(){'use strict';if(!this._getSelectedOption())return;var m=c('XPrivacySelectorLoggingController').getURIBuilder().setString('content_type',this._contentType).setEnum('event',c('PrivacySelectorEvent').CLOSE_MENU).setString('privacy_fbid',this._privacyFBID!=null?String(this._privacyFBID):null).setEnum('render_location',this._renderLocation).setBool('saved_custom_opt_in',this._config.savedCustomOptIn).getURI();new (c('AsyncRequest'))().setURI(m).send();if(this._closeForCustom){this._closeForCustom=false}else this.inform('selectorFinished');this.inform('close')};l.prototype._onPopoverOpen=function(){'use strict';var m=this.getSelectableMenu();if(!(m instanceof c('PrivacySelectableMenu')))return;c('Arbiter').inform('composerprivacy/aborteducation');m.onPopoverOpen(this._getSelectedOption());var n=c('XPrivacySelectorLoggingController').getURIBuilder().setString('content_type',this._contentType).setEnum('event',c('PrivacySelectorEvent').OPEN_MENU).setString('privacy_fbid',this._privacyFBID!=null?String(this._privacyFBID):null).setEnum('render_location',this._renderLocation).setBool('saved_custom_opt_in',this._config.savedCustomOptIn).getURI();new (c('AsyncRequest'))().setURI(n).send();this.inform('open')};l.prototype._onMenuLoad=function(){'use strict';var m=this.getSelectableMenu();this._listeners&&this._listeners.addSubscriptions(m.subscribe('itemclick',this._onItemClick.bind(this)),this.getPopover().subscribe('hide',this._onPopoverClose.bind(this)),this.getPopover().subscribe('show',this._onPopoverOpen.bind(this)));this._listeners&&this._listeners.addSubscriptions(m.subscribe(['expandMenu','expandMenuWithMore'],function(){if(this.getPopover()&&this.getPopover().getLayer())this.getPopover().getLayer().updatePosition();this._selectedOption=this._getSelectedOption()}.bind(this)));this._selectedOption=this._getSelectedOption();if(this._selectedOption){this._postParam=this._selectedOption.getPostParam().toString();this._previousParam=this._postParam;this._hasAudienceExpansion()&&this._updateTriggerButtonLabelAndIcon()}};l.prototype._hasAudienceExpansion=function(){'use strict';return this._hasTags};l.prototype._shouldDisplaySuccessAndFailure=function(){'use strict';return !!((this._config.spinner||this._config.spinnerID)&&(this._config.checkmark||this._config.checkmarkID)&&(this._config.error_icon||this._config.errorIconID))};l._savedCustomSelectorsToUpdate=[];l._sendSavedCustomUpdateRequest=c('debounce')(function(){var m=l._savedCustomSelectorsToUpdate;l._savedCustomSelectorsToUpdate=[];var n={},o={},p=false;for(var q=m,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++]}else{s=q.next();if(s.done)break;t=s.value}var u=t;n[u._postParam]=true;o[u._config.trigger_style]=true;p=p||u._menu instanceof c('PopoverLoadingMenu')}if(this._savedCustomUpdateRequest)this._savedCustomUpdateRequest.abandon();this._savedCustomUpdateRequest=new (c('AsyncRequest'))(c('XPrivacySelectorSavedCustomUpdateController').getURIBuilder().getURI()).setData({has_async_menu:p,post_params:Object.keys(n),trigger_icon_styles:Object.keys(o)}).setHandler(function(v){var w=v.payload||{},x=w.post_param_map||{},y=w.data||{},z=c('DOM').create('div',{className:'hidden_elem'});for(var aa=m,ba=Array.isArray(aa),ca=0,aa=ba?aa:aa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var da;if(ba){if(ca>=aa.length)break;da=aa[ca++]}else{ca=aa.next();if(ca.done)break;da=ca.value}var ea=da,fa=x[ea._postParam];if(!fa)continue;if(ea._menu instanceof c('PopoverLoadingMenu')){var ga=y[fa]||{};ea._postParam=fa;if(!ea._config.trigger_no_icon){var ha=ga.icons[ea._config.trigger_style];if(ha!=null){c('DOM').setContent(z,ha);var ia=z.firstChild;c('Button').setIcon(ea._button,ia)}}if(ea._shouldDisplayLabel){var ja=ga.label;ja!=null&&c('PopoverButton').setLabel(ea._button,ja)}}else if(ea._menu instanceof c('PrivacySelectableMenu')){ea._receivingUpdate=true;ea.selectOption(fa);ea._receivingUpdate=false}}c('DOM').remove(z)}).setFinallyHandler(function(){this._savedCustomUpdateRequest=null}.bind(this));this._savedCustomUpdateRequest.send()}.bind(this),10,this);f.exports=l}),null);
__d("AttachmentIssueDiversityShareConstants",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ARTICLE_CLICK:"issueDiversity\/article_click"})}),null);
__d('PubcontentFeedChainingControllerLoader',['Arbiter','AttachmentIssueDiversityShareConstants','AttachmentRelatedShareConstants','Bootloader','PageLikeConstants','SubscriptionsHandler','UFIUIEvents'],(function a(b,c,d,e,f,g){var h=[c('PageLikeConstants').LIKED,c('UFIUIEvents').ActionLinkLike,c('UFIUIEvents').ReactionButtonClicked,c('UFIUIEvents').Comment,c('UFIUIEvents').ActionAddComment,'composer/publish','LitestandComposer/publish',c('AttachmentRelatedShareConstants').ARTICLE_CLICK,c('AttachmentIssueDiversityShareConstants').ARTICLE_CLICK,c('AttachmentRelatedShareConstants').VIDEO_CLICK,c('AttachmentRelatedShareConstants').FBVIDEO_CLICK,c('AttachmentRelatedShareConstants').FBVIDEO_VIEW,c('AttachmentRelatedShareConstants').GAME_CLICK,c('AttachmentRelatedShareConstants').PHOTO_CLICK,c('AttachmentRelatedShareConstants').EVENT_JOIN,c('AttachmentRelatedShareConstants').PRODUCT_CLICK,c('AttachmentRelatedShareConstants').MAP_CLICK,c('AttachmentRelatedShareConstants').ACTION_BUTTON_CLICK],i=null,j=false,k=null,l=null,m=null,n={init:function o(p,q){l=p;m=q;if(k){k.init({isLazy:false,srs:l,sdrs:m})}else this._startListening();},_startListening:function o(){if(i)return;i=new (c('SubscriptionsHandler'))();i.addSubscriptions(c('Arbiter').subscribe(h,function(event,p){c('Arbiter').inform(event+'.lazy',p,c('Arbiter').BEHAVIOR_PERSISTENT);this._bootload()}.bind(this)))},_bootload:function o(){if(j)return;j=true;c('Bootloader').loadModules(["PubcontentFeedChainingControllerX"],function(p){i&&i.release();k=p;k.init({isLazy:true,srs:l,sdrs:m})},'PubcontentFeedChainingControllerLoader')}};f.exports=n}),null);
__d('ReactFeedComposerXBody',['DOM','Event','SubscriptionsHandler'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.$ReactFeedComposerXBody2=i.root;this.$ReactFeedComposerXBody4=c('DOM').find(this.$ReactFeedComposerXBody2,'textarea');this.$ReactFeedComposerXBody1=c('DOM').find(this.$ReactFeedComposerXBody2,'input[type="hidden"]');this.$ReactFeedComposerXBody3=new (c('SubscriptionsHandler'))();this.$ReactFeedComposerXBody3.addSubscriptions(c('Event').listen(this.$ReactFeedComposerXBody4,'change',this.$ReactFeedComposerXBody5.bind(this)))}h.prototype.$ReactFeedComposerXBody5=function(i){this.$ReactFeedComposerXBody1.value=i.target.value};f.exports=h}),null);
__d('FeedAdsGapRuleViolationDetectionFix',['csx','Banzai','BanzaiODS','CSS','DataAttributeUtils','DOM','ge','isEmpty','$'],(function a(b,c,d,e,f,g,h){var i='ei',j='qid',k='gap rule violation',l='non violating ads gap',m='non violating ego gap',n='first position violation',o='not first position violation',p='feed load',q='first position invalidation',r='spacing invalidation',s='ego_pymk',t='ego_other',u=[],v=[],w=[],x=[],y=[],z={},aa={},ba={},ca=[],da={registerFeedStories:function ea(fa,ga){if(fa.containerID=='substream_0'){u=[];v=[]}var ha=c('ge')(fa.containerID);if(!ha)return;ba=fa.egoGapRule;ca=fa.invalidateEgo?fa.egoStories:{};z=babelHelpers['extends']({},fa.demoAdChecks,z);var ia=da._getAllStoriesFromContainer(ha);if(fa.isLoggingEnabled&&ia.length!==0)da._logFeedLoad();if(fa.isNewerStories){u=ia.concat(u)}else u=u.concat(ia);for(var ja in fa.minGaps)if(Object.prototype.hasOwnProperty.call(fa.minGaps,ja))aa[ja]=fa.minGaps[ja];if(c('isEmpty')(z)){if(fa.isLoggingEnabled)da._checkFirstPosViolation(fa,ha);if(fa.isLoggingEnabled||fa.isGapRuleInvalidationEnabled)da._checkGapRuleViolation(fa);}},_getAllStoriesFromContainer:function ea(fa){return c('DOM').scry(fa,"div._5jmm").map(da._convertStoryNodeToObject).filter(function(ga){return ga!==null})},_convertStoryNodeToObject:function ea(fa){if(c('CSS').matchesSelector(fa,"._170y"))return null;var ga=fa.getAttribute('data-dedupekey');if(z[ga])return null;var ha=c('DOM').scry(fa,"div._hye"),ia=c('DOM').scry(fa,"li._170x"),ja=[];if(ha.length!==0){ja=ha.map(function(ma){return c('DataAttributeUtils').getDataFt(ma)}).filter(function(ma){return ma!==null})}else if(ia.length!==0){ja=ia.map(function(ma){return c('DataAttributeUtils').getDataFt(ma)}).filter(function(ma){return ma!==null})}else if(c('DataAttributeUtils').getDataFt(fa))ja=[c('DataAttributeUtils').getDataFt(fa)];if(!ja.length)return null;var ka=JSON.parse(ja[0]),la={dataFTArray:ja,dedupKey:ga,isSponsored:!!ka[i],isEgoPymk:ca[ga]===s,isEgoOther:ca[ga]===t,height:fa.offsetHeight,qid:parseInt(ka[j],10),nodeID:fa.id};return la},_checkFirstPosViolation:function ea(fa,ga){if(u.length>0&&!u[0].isSponsored){var ha={qid:u[0].qid};if(fa.isLoggingEnabled&&!(u[0].dedupKey in y)){da._logNotFirstPosViolation(ha);y[u[0].dedupKey]=ha}}while(u.length>0&&u[0].isSponsored){var ha={ftArray:u[0].dataFTArray,qid:u[0].qid,nodeid:u[0].nodeID,firstStoryType:fa.firstStoryType},ia=c('DOM').scry(ga,'.uiBoxRed')[0];if(ia){var ja=ia.textContent||ia.innerText;if(ja)ha.error_msg=ja;}if(fa.isLoggingEnabled&&!(u[0].dedupKey in x)){da._logFirstPosViolation(ha);x[u[0].dedupKey]=ha}break}},_getMinGap:function ea(fa,ga,ha){var ia=Math.min(fa?fa:Number.MAX_VALUE,ga?ga:Number.MAX_VALUE);return ia!==Number.MAX_VALUE?ia:ha},_getStoryDedupKeys:function ea(){return u.map(function(fa){return fa.dedupKey})},_getStoryDedupKeysJSONString:function ea(fa,ga){var ha=[];for(var ia=fa;ia<=ga;ia++)ha.push(u[ia].dedupKey);return JSON.stringify(ha)},_getIdxOfStoryToSwap:function ea(fa,ga){if(ga>=u.length-fa)return -1;for(var ha=fa+1;ha<u.length&&ga>0;ha++){if(!u[ha].isSponsored&&!u[ha].isEgoPymk&&!u[ha].isEgoOther){ga--}else return -1;if(ga===0)return ha;}return -1},_checkGapRuleViolation:function ea(fa){var ga=null,ha=null,ia=null;for(var ja=0;ja<u.length;ja++){var ka=u[ja],la=c('ge')(ka.nodeID);if(!la||!c('CSS').shown(la)){u.splice(ja,1);continue}if(ka.isSponsored){var ma=false,na=false;if(ha!==null){var oa=ja-ha,pa=null,qa=null;if(ga===ha){qa=da._getMinGap(aa[ia.dedupKey],aa[ka.dedupKey],fa.defaultMinGap)}else qa=da._getMinGapBetweenStories(ia,ka);var ra=null;if(oa<qa){pa=k;ra=ha}else{pa=l;ra=ga}if(fa.isLoggingEnabled)if(!(ka.dedupKey in v)||v[ka.dedupKey].event_type!==pa){da._logGapEvent(pa,ra,ja);v[ka.dedupKey]={event_type:pa}}if(fa.isGapRuleInvalidationEnabled&&pa==k){var sa=-1;if(fa.isSwapOnGapRuleViolationEnabled)sa=da._getIdxOfStoryToSwap(ja,qa-oa);if(sa>0){da._shiftAdOrEgoBelowOrganicStory(ka.nodeID,u[sa].nodeID);var ta=u[ja];u.splice(ja,1);u.splice(sa,0,ta);if(fa.isLoggingEnabled){var ua={ft:u[sa].dataFTArray[0],dist:sa-ja,qid:u[sa].qid,event_type:'ad_swap'};c('Banzai').post('feed_ads_gap_rule_violation',ua)}na=true}else if(fa.isGapRuleInvalidationEnabled){da._invalidateGapRuleViolatedAd(ia,ka);ma=true;u.splice(ja--,1)}}}if(!ma&&!na){ga=ja;ha=ja;ia=ka}}if(fa.invalidateEgo&&(ka.isEgoPymk||ka.isEgoOther)){var va=false;if(ha!==null){var wa=ja-ha,xa=da._getMinGapBetweenStories(ia,ka);if(wa<xa){va=true;var ya=-1,za=xa-wa,ab=ja+1;for(;ab<u.length;ab++){if(u[ab].isSponsored||u[ab].isEgoPymk||u[ab].isEgoOther){break}else za--;if(za===0){ya=ab;break}}if(ya>0){da._swapAndLogEgo(ja,ab)}else{da._invalidateAndLogEgo(ja);ja--}}else if(fa.shouldLogEgo&&!w[ka.dedupKey]){w[ka.dedupKey]=true;da._logGapEvent(m,ha,ja)}}if(!va){ha=ja;ia=ka}}}},_getMinGapBetweenStories:function ea(fa,ga){var ha='';if(fa.isSponsored||fa.isEgoOther){ha='ad'}else if(fa.isEgoPymk){ha='pymk'}else return 0;var ia='';if(ga.isSponsored||ga.isEgoOther){ia='ad'}else if(ga.isEgoPymk){ia='pymk'}else return 0;return ba[ha+'_'+ia]},_swapAndLogEgo:function ea(fa,ga){da._shiftAdOrEgoBelowOrganicStory(u[fa].nodeID,u[ga].nodeID);var ha=u[fa];u.splice(fa,1);u.splice(ga,0,ha);c('BanzaiODS').bumpEntityKey('feed_ego_invalidation','swap')},_invalidateAndLogEgo:function ea(fa){var ga=c('ge')(u[fa].nodeID);ga&&c('CSS').hide(ga);u.splice(fa,1);c('BanzaiODS').bumpEntityKey('feed_ego_invalidation','invalidate')},_logFirstPosViolation:function ea(fa){var ga={ft:fa.ftArray[0],event_type:n,intValues:{qid:fa.qid},first_story_type:fa.firstStoryType};if(fa.error_msg)ga.error_msg=fa.error_msg;c('Banzai').post('feed_ads_gap_rule_violation',ga)},_logNotFirstPosViolation:function ea(fa){var ga={event_type:o,intValues:{qid:fa.qid}};if(fa.error_msg)ga.error_msg=fa.error_msg;c('Banzai').post('feed_ads_gap_rule_violation',ga)},_logGapEvent:function ea(fa,ga,ha){if(ga===null)return;var ia=u[ga],ja=u[ha],ka=0;for(var la=ga+1;la<ha;la++)ka+=u[la].height;var ma={ft_A:ia.dataFTArray[0],ft_B:ja.dataFTArray[0],event_type:fa,intValues:{dist:ha-ga,pdist:ka,pos:ha+1,qid_A:ia.qid,qid_B:ja.qid},strValues:{previous_unit_type:da._getUnitTypeForLogging(ia),unit_type:da._getUnitTypeForLogging(ja)},dedup_keys:da._getStoryDedupKeysJSONString(ga,ha)};c('Banzai').post('feed_ads_gap_rule_violation',ma)},_getUnitTypeForLogging:function ea(fa){if(fa.isSponsored){return 'ad'}else if(fa.isEgoPymk){return 'pymk'}else if(fa.isEgoOther)return 'ego_other';return null},_logFeedLoad:function ea(){var fa={event_type:p};c('Banzai').post('feed_ads_gap_rule_violation',fa)},_invalidateFirstPosAd:function ea(fa){c('CSS').hide(c('$')(fa.nodeid));var ga={ft_array:fa.ftArray,event_type:q};c('Banzai').post('feed_ads_gap_rule_violation',ga)},_invalidateGapRuleViolatedAd:function ea(fa,ga){var ha=c('ge')(ga.nodeID);ha&&c('CSS').hide(ha);var ia={ft_array_A:fa.dataFTArray[0],ft_array_B:ga.dataFTArray[0],event_type:r};c('Banzai').post('feed_ads_gap_rule_violation',ia)},_shiftAdOrEgoBelowOrganicStory:function ea(fa,ga){var ha=c('ge')(fa),ia=c('ge')(ga);ha&&ia&&c('DOM').insertAfter(ia,ha)}};f.exports=da}),null);
__d('StoryPositionTracking',['csx','DataAttributeUtils','DOM','ge'],(function a(b,c,d,e,f,g,h){var i="._5jmm",j=0,k={registerNewStories:function l(m){if(m=='substream_0')j=0;c('DOM').scry(c('ge')(m),i).forEach(function(n){var o=JSON.parse(c('DataAttributeUtils').getDataFt(n));if(o){o.insertion_position=j++;c('DataAttributeUtils').setDataFt(n,JSON.stringify(o))}})}};f.exports=k}),null);
__d('FbFeedAttachmentRelatedShare',['csx','Arbiter','AttachmentIssueDiversityShareConstants','AttachmentRelatedShareConstants','DOMQuery','Event','tidyEvent'],(function a(b,c,d,e,f,g,h){var i={loadRelatedAttachment:function j(k,l){c('tidyEvent')(c('Event').listen(k,'click',function(){c('Arbiter').inform(c('AttachmentRelatedShareConstants').ARTICLE_CLICK,{attachment:k,global_share_id:l})}))},loadRelatedGameAttachment:function j(k,l){c('tidyEvent')(c('Event').listen(k,'click',function(){c('Arbiter').inform(c('AttachmentRelatedShareConstants').GAME_CLICK,{attachment:k,global_share_id:l})}))},loadRelatedAttachmentForStream:function j(k){i._loadChainableAttachmentForStreamImpl(k,c('AttachmentRelatedShareConstants').ARTICLE_CLICK)},loadIssueDiversityAttachmentForStream:function j(k){i._loadChainableAttachmentForStreamImpl(k,c('AttachmentIssueDiversityShareConstants').ARTICLE_CLICK)},_loadChainableAttachmentForStreamImpl:function j(k,l){var m=function n(event,o){var p=event.getTarget();if(p.getAttribute('target')!=='_blank')return;var q="^div._5pbx",r="^div._5pc9",s=c('DOMQuery').scry(p,q)[0]||c('DOMQuery').scry(p,r)[0];if(!s)return;c('Arbiter').inform(l,{attachment:s,global_share_id:0,link_url:p.getAttribute('href'),is_right_click:o})};c('tidyEvent')(c('Event').listen(k,'click',function(event){m(event,false)}));c('tidyEvent')(c('Event').listen(k,'mousedown',function(event){if(event.which==3||event.button==2)m(event,true);}))}};f.exports=i}),null);
__d('FbFeedViewportTracking',['csx','Arbiter','LitestandMessages','LitestandStream','StreamViewportTracking','viewportTrackingBuilder'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;function k(n,o){return c('StreamViewportTracking').getBehavior(n,c('LitestandStream').getStreamRoot(),o)}i=babelHelpers.inherits(l,c('StreamViewportTracking'));j=i&&i.prototype;l.prototype.init=function(n){j.init.call(this,n);this.invalidateAllStoriesCache=this.invalidateAllStoriesCache.bind(this);this.stopTimeTrackingData=this.updateTimeTrackingData.bind(this,true);this.subscriptions.addSubscriptions(c('Arbiter').subscribe(c('LitestandMessages').STORIES_INSERTED,this.invalidateAllStoriesCache),c('Arbiter').subscribe(c('LitestandMessages').LEAVE_HOME,this.stopTimeTrackingData))};l.prototype.getSessionID=function(){return c('LitestandStream').isReady()?c('LitestandStream').getFeedStreamID():null};l.prototype.cleanup=function(){m.clearSingleton();j.cleanup.call(this)};function l(){i.apply(this,arguments)}var m=c('viewportTrackingBuilder')(function(n){var o=new l(k(n,"._5jmm"));o.init(n);return o});m.init=m.factory.bind(m);f.exports=m}),null);
__d('GoodwillTemplateBanzaiLogger',['Banzai'],(function a(b,c,d,e,f,g){'use strict';var h={logClickEvent:function i(j,k){j.onclick=function(){if(k.goodwill_memories_and_celebrations)c('Banzai').post('goodwill_memories_and_celebrations',k.goodwill_memories_and_celebrations);if(k.goodwill_video)c('Banzai').post('goodwill_video',k.goodwill_video);}}};f.exports=h}),null);
__d("XDOMScannerResultsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ascend_mr_no\/",{})}),null);